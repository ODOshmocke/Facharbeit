{% extends "base.html" %}

{% block title %}Registrieren{% endblock %}

{% block content %}
    <div class="row justify-content-center">
        <div class="col-md-5">
            <div class="card p-4">
                <h3 class="text-center mb-4 fw-bold text-primary">Konto erstellen</h3>
                <form id="signup-form">
                    <label>Benutzername</label>
                    <input type="text" id="username" required>

                    <label>E-Mail (optional)</label>
                    <input type="email" id="email">

                    <label>Passwort</label>
                    <input type="password" id="password" required>

                    <button type="submit" class="btn btn-custom w-100 mt-3">Registrieren</button>
                </form>
                <p class="text-center mt-4">
                    Schon ein Konto? <a href="/login/">Hier einloggen</a>
                </p>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
    <script>
        document.getElementById('signup-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const data = {
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
            };

            fetch('/signup/', {
                method: 'POST',
                headers: apiHeaders,
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        alert("Erfolgreich registriert! Logge dich jetzt ein.");
                        window.location.href = '/login/';
                    } else {
                        alert("Fehler bei der Registrierung.");
                    }
                });
        });
    </script>
{% endblock %}